import React, { useEffect, useState } from "react";
import { fetchHistoricalData } from "../../Api/DataProvider";
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
} from "chart.js";
import { Line } from "react-chartjs-2";
import { Container } from "react-bootstrap";

interface HistoricalData {
  [currency: string]: {
    [date: string]: number;
  };
}
ChartJS.register(CategoryScale, LinearScale, PointElement, LineElement);
const data = {
  "2022-06-05": {
    USD: 1.07257,
  },
  "2022-06-06": {
    USD: 1.069107,
  },
  "2022-06-07": {
    USD: 1.069744,
  },
  "2022-06-08": {
    USD: 1.071731,
  },
  "2022-06-09": {
    USD: 1.061887,
  },
  "2022-06-10": {
    USD: 1.051785,
  },
  "2022-06-11": {
    USD: 1.051785,
  },
  "2022-06-12": {
    USD: 1.048944,
  },
  "2022-06-13": {
    USD: 1.041482,
  },
  "2022-06-14": {
    USD: 1.043952,
  },
  "2022-06-15": {
    USD: 1.045586,
  },
  "2022-06-16": {
    USD: 1.054652,
  },
  "2022-06-17": {
    USD: 1.049534,
  },
  "2022-06-18": {
    USD: 1.049534,
  },
  "2022-06-19": {
    USD: 1.049109,
  },
  "2022-06-20": {
    USD: 1.051912,
  },
  "2022-06-21": {
    USD: 1.05323,
  },
  "2022-06-22": {
    USD: 1.056245,
  },
  "2022-06-23": {
    USD: 1.051978,
  },
  "2022-06-24": {
    USD: 1.055687,
  },
  "2022-06-25": {
    USD: 1.055687,
  },
  "2022-06-26": {
    USD: 1.056574,
  },
  "2022-06-27": {
    USD: 1.058056,
  },
  "2022-06-28": {
    USD: 1.052321,
  },
  "2022-06-29": {
    USD: 1.044626,
  },
  "2022-06-30": {
    USD: 1.047735,
  },
  "2022-07-01": {
    USD: 1.042857,
  },
  "2022-07-02": {
    USD: 1.042857,
  },
  "2022-07-03": {
    USD: 1.043362,
  },
  "2022-07-04": {
    USD: 1.043286,
  },
  "2022-07-05": {
    USD: 1.027079,
  },
  "2022-07-06": {
    USD: 1.018382,
  },
  "2022-07-07": {
    USD: 1.016369,
  },
  "2022-07-08": {
    USD: 1.018589,
  },
  "2022-07-09": {
    USD: 1.018589,
  },
  "2022-07-10": {
    USD: 1.018589,
  },
  "2022-07-11": {
    USD: 1.008141,
  },
  "2022-07-12": {
    USD: 1.0022,
  },
  "2022-07-13": {
    USD: 1.003235,
  },
  "2022-07-14": {
    USD: 1.002531,
  },
  "2022-07-15": {
    USD: 1.008695,
  },
  "2022-07-16": {
    USD: 1.008695,
  },
  "2022-07-17": {
    USD: 1.009589,
  },
  "2022-07-18": {
    USD: 1.014482,
  },
  "2022-07-19": {
    USD: 1.023096,
  },
  "2022-07-20": {
    USD: 1.018242,
  },
  "2022-07-21": {
    USD: 1.022072,
  },
  "2022-07-22": {
    USD: 1.021408,
  },
  "2022-07-23": {
    USD: 1.021408,
  },
  "2022-07-24": {
    USD: 1.019987,
  },
  "2022-07-25": {
    USD: 1.022338,
  },
  "2022-07-26": {
    USD: 1.01292,
  },
  "2022-07-27": {
    USD: 1.020773,
  },
  "2022-07-28": {
    USD: 1.019197,
  },
  "2022-07-29": {
    USD: 1.022547,
  },
  "2022-07-30": {
    USD: 1.022547,
  },
  "2022-07-31": {
    USD: 1.020668,
  },
  "2022-08-01": {
    USD: 1.026099,
  },
  "2022-08-02": {
    USD: 1.015533,
  },
  "2022-08-03": {
    USD: 1.015729,
  },
  "2022-08-04": {
    USD: 1.024742,
  },
  "2022-08-05": {
    USD: 1.018024,
  },
  "2022-08-06": {
    USD: 1.018024,
  },
  "2022-08-07": {
    USD: 1.017051,
  },
  "2022-08-08": {
    USD: 1.019727,
  },
  "2022-08-09": {
    USD: 1.020778,
  },
  "2022-08-10": {
    USD: 1.029919,
  },
  "2022-08-11": {
    USD: 1.031513,
  },
  "2022-08-12": {
    USD: 1.026352,
  },
  "2022-08-13": {
    USD: 1.026352,
  },
  "2022-08-14": {
    USD: 1.025483,
  },
  "2022-08-15": {
    USD: 1.016162,
  },
  "2022-08-16": {
    USD: 1.01703,
  },
  "2022-08-17": {
    USD: 1.017863,
  },
  "2022-08-18": {
    USD: 1.008954,
  },
  "2022-08-19": {
    USD: 1.004182,
  },
  "2022-08-20": {
    USD: 1.004182,
  },
  "2022-08-21": {
    USD: 1.003487,
  },
  "2022-08-22": {
    USD: 0.993912,
  },
  "2022-08-23": {
    USD: 0.996656,
  },
  "2022-08-24": {
    USD: 0.99676,
  },
  "2022-08-25": {
    USD: 0.997093,
  },
  "2022-08-26": {
    USD: 0.996561,
  },
  "2022-08-27": {
    USD: 0.996561,
  },
  "2022-08-28": {
    USD: 0.993833,
  },
  "2022-08-29": {
    USD: 1.001252,
  },
  "2022-08-30": {
    USD: 1.002471,
  },
  "2022-08-31": {
    USD: 1.00387,
  },
  "2022-09-01": {
    USD: 0.995198,
  },
  "2022-09-02": {
    USD: 0.995768,
  },
  "2022-09-03": {
    USD: 0.995768,
  },
  "2022-09-04": {
    USD: 0.990908,
  },
  "2022-09-05": {
    USD: 0.995074,
  },
  "2022-09-06": {
    USD: 0.989761,
  },
  "2022-09-07": {
    USD: 0.999535,
  },
  "2022-09-08": {
    USD: 1.001051,
  },
  "2022-09-09": {
    USD: 1.015176,
  },
  "2022-09-10": {
    USD: 1.015383,
  },
  "2022-09-11": {
    USD: 1.007105,
  },
  "2022-09-12": {
    USD: 1.01292,
  },
  "2022-09-13": {
    USD: 0.998054,
  },
  "2022-09-14": {
    USD: 0.998253,
  },
  "2022-09-15": {
    USD: 0.998796,
  },
  "2022-09-16": {
    USD: 1.001532,
  },
  "2022-09-17": {
    USD: 1.00163,
  },
  "2022-09-18": {
    USD: 1.002115,
  },
  "2022-09-19": {
    USD: 1.00245,
  },
  "2022-09-20": {
    USD: 0.997044,
  },
  "2022-09-21": {
    USD: 0.983038,
  },
  "2022-09-22": {
    USD: 0.98401,
  },
  "2022-09-23": {
    USD: 0.968964,
  },
  "2022-09-24": {
    USD: 0.968964,
  },
  "2022-09-25": {
    USD: 0.968851,
  },
  "2022-09-26": {
    USD: 0.962232,
  },
  "2022-09-27": {
    USD: 0.959582,
  },
  "2022-09-28": {
    USD: 0.970784,
  },
  "2022-09-29": {
    USD: 0.982922,
  },
  "2022-09-30": {
    USD: 0.980478,
  },
  "2022-10-01": {
    USD: 0.980478,
  },
  "2022-10-02": {
    USD: 0.979235,
  },
  "2022-10-03": {
    USD: 0.983173,
  },
  "2022-10-04": {
    USD: 0.998398,
  },
  "2022-10-05": {
    USD: 0.991066,
  },
  "2022-10-06": {
    USD: 0.978871,
  },
  "2022-10-07": {
    USD: 0.974013,
  },
  "2022-10-08": {
    USD: 0.974013,
  },
  "2022-10-09": {
    USD: 0.973468,
  },
  "2022-10-10": {
    USD: 0.970973,
  },
  "2022-10-11": {
    USD: 0.969984,
  },
  "2022-10-12": {
    USD: 0.970765,
  },
  "2022-10-13": {
    USD: 0.974943,
  },
  "2022-10-14": {
    USD: 0.972337,
  },
  "2022-10-15": {
    USD: 0.972337,
  },
  "2022-10-16": {
    USD: 0.973904,
  },
  "2022-10-17": {
    USD: 0.984443,
  },
  "2022-10-18": {
    USD: 0.986241,
  },
  "2022-10-19": {
    USD: 0.976615,
  },
  "2022-10-20": {
    USD: 0.977856,
  },
  "2022-10-21": {
    USD: 0.986144,
  },
  "2022-10-22": {
    USD: 0.986144,
  },
  "2022-10-23": {
    USD: 0.98595,
  },
  "2022-10-24": {
    USD: 0.988616,
  },
  "2022-10-25": {
    USD: 0.996338,
  },
  "2022-10-26": {
    USD: 1.009158,
  },
  "2022-10-27": {
    USD: 0.996746,
  },
  "2022-10-28": {
    USD: 0.996462,
  },
  "2022-10-29": {
    USD: 0.996462,
  },
  "2022-10-30": {
    USD: 0.995406,
  },
  "2022-10-31": {
    USD: 0.988665,
  },
  "2022-11-01": {
    USD: 0.987884,
  },
  "2022-11-02": {
    USD: 0.981619,
  },
  "2022-11-03": {
    USD: 0.974968,
  },
  "2022-11-04": {
    USD: 0.998352,
  },
  "2022-11-05": {
    USD: 0.998352,
  },
  "2022-11-06": {
    USD: 0.993004,
  },
  "2022-11-07": {
    USD: 1.001828,
  },
  "2022-11-08": {
    USD: 1.007927,
  },
  "2022-11-09": {
    USD: 1.001445,
  },
  "2022-11-10": {
    USD: 1.01942,
  },
  "2022-11-11": {
    USD: 1.037183,
  },
  "2022-11-12": {
    USD: 1.03729,
  },
  "2022-11-13": {
    USD: 1.032818,
  },
  "2022-11-14": {
    USD: 1.031891,
  },
  "2022-11-15": {
    USD: 1.035824,
  },
  "2022-11-16": {
    USD: 1.039426,
  },
  "2022-11-17": {
    USD: 1.036135,
  },
  "2022-11-18": {
    USD: 1.03455,
  },
  "2022-11-19": {
    USD: 1.03455,
  },
  "2022-11-20": {
    USD: 1.033053,
  },
  "2022-11-21": {
    USD: 1.024333,
  },
  "2022-11-22": {
    USD: 1.030954,
  },
  "2022-11-23": {
    USD: 1.041591,
  },
  "2022-11-24": {
    USD: 1.040778,
  },
  "2022-11-25": {
    USD: 1.041445,
  },
  "2022-11-26": {
    USD: 1.041445,
  },
  "2022-11-27": {
    USD: 1.036683,
  },
  "2022-11-28": {
    USD: 1.034313,
  },
  "2022-11-29": {
    USD: 1.032199,
  },
  "2022-11-30": {
    USD: 1.042372,
  },
  "2022-12-01": {
    USD: 1.052798,
  },
  "2022-12-02": {
    USD: 1.053685,
  },
  "2022-12-03": {
    USD: 1.054085,
  },
  "2022-12-04": {
    USD: 1.054196,
  },
  "2022-12-05": {
    USD: 1.049659,
  },
  "2022-12-06": {
    USD: 1.04666,
  },
  "2022-12-07": {
    USD: 1.051293,
  },
  "2022-12-08": {
    USD: 1.055853,
  },
  "2022-12-09": {
    USD: 1.054736,
  },
  "2022-12-10": {
    USD: 1.054685,
  },
  "2022-12-11": {
    USD: 1.052177,
  },
  "2022-12-12": {
    USD: 1.054141,
  },
  "2022-12-13": {
    USD: 1.062632,
  },
  "2022-12-14": {
    USD: 1.067634,
  },
  "2022-12-15": {
    USD: 1.063886,
  },
  "2022-12-16": {
    USD: 1.059714,
  },
  "2022-12-17": {
    USD: 1.059939,
  },
  "2022-12-18": {
    USD: 1.058403,
  },
  "2022-12-19": {
    USD: 1.061348,
  },
  "2022-12-20": {
    USD: 1.06253,
  },
  "2022-12-21": {
    USD: 1.060839,
  },
  "2022-12-22": {
    USD: 1.060165,
  },
  "2022-12-23": {
    USD: 1.066548,
  },
  "2022-12-24": {
    USD: 1.066776,
  },
  "2022-12-25": {
    USD: 1.066782,
  },
  "2022-12-26": {
    USD: 1.063988,
  },
  "2022-12-27": {
    USD: 1.063683,
  },
  "2022-12-28": {
    USD: 1.062869,
  },
  "2022-12-29": {
    USD: 1.066155,
  },
  "2022-12-30": {
    USD: 1.072673,
  },
  "2022-12-31": {
    USD: 1.072673,
  },
  "2023-01-01": {
    USD: 1.070452,
  },
  "2023-01-02": {
    USD: 1.067737,
  },
  "2023-01-03": {
    USD: 1.054652,
  },
  "2023-01-04": {
    USD: 1.060839,
  },
  "2023-01-05": {
    USD: 1.052192,
  },
  "2023-01-06": {
    USD: 1.066382,
  },
  "2023-01-07": {
    USD: 1.066382,
  },
  "2023-01-08": {
    USD: 1.065598,
  },
  "2023-01-09": {
    USD: 1.073445,
  },
  "2023-01-10": {
    USD: 1.07386,
  },
  "2023-01-11": {
    USD: 1.076414,
  },
  "2023-01-12": {
    USD: 1.085977,
  },
  "2023-01-13": {
    USD: 1.084775,
  },
  "2023-01-14": {
    USD: 1.084775,
  },
  "2023-01-15": {
    USD: 1.082427,
  },
  "2023-01-16": {
    USD: 1.082978,
  },
  "2023-01-17": {
    USD: 1.078737,
  },
  "2023-01-18": {
    USD: 1.079727,
  },
  "2023-01-19": {
    USD: 1.083506,
  },
  "2023-01-20": {
    USD: 1.087661,
  },
  "2023-01-21": {
    USD: 1.087725,
  },
  "2023-01-22": {
    USD: 1.086461,
  },
  "2023-01-23": {
    USD: 1.087217,
  },
  "2023-01-24": {
    USD: 1.088779,
  },
  "2023-01-25": {
    USD: 1.092167,
  },
  "2023-01-26": {
    USD: 1.089448,
  },
  "2023-01-27": {
    USD: 1.087251,
  },
  "2023-01-28": {
    USD: 1.087251,
  },
  "2023-01-29": {
    USD: 1.08711,
  },
  "2023-01-30": {
    USD: 1.084945,
  },
  "2023-01-31": {
    USD: 1.086106,
  },
  "2023-02-01": {
    USD: 1.101248,
  },
  "2023-02-02": {
    USD: 1.090477,
  },
  "2023-02-03": {
    USD: 1.082778,
  },
  "2023-02-04": {
    USD: 1.082778,
  },
  "2023-02-05": {
    USD: 1.079051,
  },
  "2023-02-06": {
    USD: 1.072935,
  },
  "2023-02-07": {
    USD: 1.072938,
  },
  "2023-02-08": {
    USD: 1.071639,
  },
  "2023-02-09": {
    USD: 1.074056,
  },
  "2023-02-10": {
    USD: 1.069919,
  },
  "2023-02-11": {
    USD: 1.070148,
  },
  "2023-02-12": {
    USD: 1.067834,
  },
  "2023-02-13": {
    USD: 1.073008,
  },
  "2023-02-14": {
    USD: 1.073503,
  },
  "2023-02-15": {
    USD: 1.069198,
  },
  "2023-02-16": {
    USD: 1.066555,
  },
  "2023-02-17": {
    USD: 1.071983,
  },
  "2023-02-18": {
    USD: 1.072036,
  },
  "2023-02-19": {
    USD: 1.068492,
  },
  "2023-02-20": {
    USD: 1.068319,
  },
  "2023-02-21": {
    USD: 1.065167,
  },
  "2023-02-22": {
    USD: 1.060556,
  },
  "2023-02-23": {
    USD: 1.059828,
  },
  "2023-02-24": {
    USD: 1.058481,
  },
  "2023-02-25": {
    USD: 1.05842,
  },
  "2023-02-26": {
    USD: 1.055431,
  },
  "2023-02-27": {
    USD: 1.060951,
  },
  "2023-02-28": {
    USD: 1.057686,
  },
  "2023-03-01": {
    USD: 1.066906,
  },
  "2023-03-02": {
    USD: 1.05994,
  },
  "2023-03-03": {
    USD: 1.064917,
  },
  "2023-03-04": {
    USD: 1.065019,
  },
  "2023-03-05": {
    USD: 1.062631,
  },
  "2023-03-06": {
    USD: 1.068661,
  },
  "2023-03-07": {
    USD: 1.05493,
  },
  "2023-03-08": {
    USD: 1.054952,
  },
  "2023-03-09": {
    USD: 1.058436,
  },
  "2023-03-10": {
    USD: 1.065753,
  },
  "2023-03-11": {
    USD: 1.065753,
  },
  "2023-03-12": {
    USD: 1.068331,
  },
  "2023-03-13": {
    USD: 1.072329,
  },
  "2023-03-14": {
    USD: 1.072729,
  },
  "2023-03-15": {
    USD: 1.058301,
  },
  "2023-03-16": {
    USD: 1.061379,
  },
  "2023-03-17": {
    USD: 1.075211,
  },
  "2023-03-18": {
    USD: 1.075211,
  },
  "2023-03-19": {
    USD: 1.067839,
  },
  "2023-03-20": {
    USD: 1.07188,
  },
  "2023-03-21": {
    USD: 1.077389,
  },
  "2023-03-22": {
    USD: 1.087004,
  },
  "2023-03-23": {
    USD: 1.083517,
  },
  "2023-03-24": {
    USD: 1.078046,
  },
  "2023-03-25": {
    USD: 1.078162,
  },
  "2023-03-26": {
    USD: 1.07765,
  },
  "2023-03-27": {
    USD: 1.080672,
  },
  "2023-03-28": {
    USD: 1.083823,
  },
  "2023-03-29": {
    USD: 1.084328,
  },
  "2023-03-30": {
    USD: 1.090441,
  },
  "2023-03-31": {
    USD: 1.08707,
  },
  "2023-04-01": {
    USD: 1.08707,
  },
  "2023-04-02": {
    USD: 1.080567,
  },
  "2023-04-03": {
    USD: 1.091048,
  },
  "2023-04-04": {
    USD: 1.09583,
  },
  "2023-04-05": {
    USD: 1.090406,
  },
  "2023-04-06": {
    USD: 1.091977,
  },
  "2023-04-07": {
    USD: 1.099621,
  },
  "2023-04-08": {
    USD: 1.099621,
  },
  "2023-04-09": {
    USD: 1.091239,
  },
  "2023-04-10": {
    USD: 1.086897,
  },
  "2023-04-11": {
    USD: 1.091716,
  },
  "2023-04-12": {
    USD: 1.099699,
  },
  "2023-04-13": {
    USD: 1.105131,
  },
  "2023-04-14": {
    USD: 1.110366,
  },
  "2023-04-15": {
    USD: 1.110366,
  },
  "2023-04-16": {
    USD: 1.098478,
  },
  "2023-04-17": {
    USD: 1.092502,
  },
  "2023-04-18": {
    USD: 1.097563,
  },
  "2023-04-19": {
    USD: 1.095182,
  },
  "2023-04-20": {
    USD: 1.096828,
  },
  "2023-04-21": {
    USD: 1.10975,
  },
  "2023-04-22": {
    USD: 1.10975,
  },
  "2023-04-23": {
    USD: 1.099191,
  },
  "2023-04-24": {
    USD: 1.105767,
  },
  "2023-04-25": {
    USD: 1.097936,
  },
  "2023-04-26": {
    USD: 1.104496,
  },
  "2023-04-27": {
    USD: 1.103141,
  },
  "2023-04-28": {
    USD: 1.112713,
  },
  "2023-04-29": {
    USD: 1.112713,
  },
  "2023-04-30": {
    USD: 1.101055,
  },
  "2023-05-01": {
    USD: 1.096851,
  },
  "2023-05-02": {
    USD: 1.101055,
  },
  "2023-05-03": {
    USD: 1.106856,
  },
  "2023-05-04": {
    USD: 1.102256,
  },
  "2023-05-05": {
    USD: 1.121026,
  },
  "2023-05-06": {
    USD: 1.121026,
  },
  "2023-05-07": {
    USD: 1.101831,
  },
  "2023-05-08": {
    USD: 1.099578,
  },
  "2023-05-09": {
    USD: 1.096431,
  },
  "2023-05-10": {
    USD: 1.09837,
  },
  "2023-05-11": {
    USD: 1.091179,
  },
  "2023-05-12": {
    USD: 1.093967,
  },
  "2023-05-13": {
    USD: 1.093967,
  },
  "2023-05-14": {
    USD: 1.085234,
  },
  "2023-05-15": {
    USD: 1.087335,
  },
  "2023-05-16": {
    USD: 1.086532,
  },
  "2023-05-17": {
    USD: 1.083799,
  },
  "2023-05-18": {
    USD: 1.077505,
  },
  "2023-05-19": {
    USD: 1.082363,
  },
  "2023-05-20": {
    USD: 1.082363,
  },
  "2023-05-21": {
    USD: 1.082239,
  },
  "2023-05-22": {
    USD: 1.08107,
  },
  "2023-05-23": {
    USD: 1.076936,
  },
  "2023-05-24": {
    USD: 1.075558,
  },
  "2023-05-25": {
    USD: 1.07241,
  },
  "2023-05-26": {
    USD: 1.073134,
  },
  "2023-05-27": {
    USD: 1.073134,
  },
  "2023-05-28": {
    USD: 1.072268,
  },
  "2023-05-29": {
    USD: 1.070733,
  },
  "2023-05-30": {
    USD: 1.073134,
  },
  "2023-05-31": {
    USD: 1.069347,
  },
  "2023-06-01": {
    USD: 1.076044,
  },
  "2023-06-02": {
    USD: 1.072558,
  },
  "2023-06-03": {
    USD: 1.072558,
  },
  "2023-06-04": {
    USD: 1.069745,
  },
  "2023-06-05": {
    USD: 1.071248,
  },
};

const transformedData = Object.entries(data).reduce((result: { [key: string]: any }, [date, rate]) => {
    const [year, month, day] = new Date(date).toISOString().split('T')[0].split('-');
    const key = `${year}-${month}`;
    
    if (!result[key] || day > result[key].split('-')[2]) {
      result[key] = date;
    }
    
    return result;
  }, {});
  

  
const HistoricalChart: React.FC = () => {
  const [chartData, setChartData] = useState<any>();

  const fetchHistoricalChartData = async () => {
    try {
      const historicalData = await fetchHistoricalData("EUR", "USD");

      setChartData(historicalData);
    } catch (error) {
      console.error("Error fetching currencies:", error);
    }
  };
  useEffect(() => {
    fetchHistoricalChartData();
  }, []);

  return (
    <>
{console.log("transformedData",transformedData)
}
      <Container className="p-5">
        {chartData ? (
          <Line
            data={chartData}
            options={{
              responsive: true,
              plugins: {
                legend: {
                  position: "top" as const,
                },
                title: {
                  display: true,
                  text: "Chart.js Line Chart",
                },
              },
            }}
          />
        ) : (
          <div>Loading chart data...</div>
        )}
      </Container>
    </>
  );
};

export default HistoricalChart;
